{% extends "base.html.twig" %}

{% block content %}
    <div class="container py-3">
        <h1>{{ video.name }}</h1>

        <div class="row">
            <div class="col-12 col-lg-10">
                <div class="embed-responsive embed-responsive-16by9">
                    <div id="player"></div>
                </div>
            </div>
            <div class="col-12 col-lg-2">
                {% for category in categories %}
                    <a href="{{ path('home_category', {'category': category.id}) }}">
                        {{ category.name }}
                    </a>
                {% endfor %}
            </div>
        </div>

    </div>
{% endblock %}

{% block body_javascript %}
    {{ parent() }}
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
    var player;
    var playerStatus;

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '390',
        width: '640',
        videoId: '{{ video.video }}',
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerReady(event) {
      event.target.playVideo();
      console.log(event.target);
    }

    function onPlayerStateChange(event) {
      playerStatus = event.data;
      console.log(event.data);
    }

    document.addEventListener('keydown', checkKey);

    function checkKey(event) {
      if (event.code.toLowerCase() === 'space') {
        if (playerStatus === YT.PlayerState.PLAYING) {
          player.pauseVideo();
        }
        if (playerStatus === YT.PlayerState.PAUSED) {
          player.playVideo();
        }
      }
    }

    </script>
{% endblock %}
